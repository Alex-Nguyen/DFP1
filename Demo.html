<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
</head>
<script>
   //Input data is two dimentional matrix [[0.4,0.5,0.9],[0.1,0.3,0.7]]
   function drawMatrix(input2DMatrix,colLabel,rowLabel) {
       let rect_width=20,
           rect_height=20,
           spacing=5,
           svgheight = (rect_height+spacing)*input2DMatrix.length;

       var svgMatrix = d3.select('#matrix').append('svg').attr('height',svgheight+300).attr('width',"100%");//create svg
       matrix.forEach(function (row,index) { //loop through matrix input
           var group = svgMatrix.append('g').attr('height',12).attr('transform','translate(200,'+index*(rect_height+spacing)+')');//append (g);

           var rect = group.selectAll('rect')//start drawing rect from left to rigth
               .data(row)
               .enter()
               .append('rect')
               .attr("class",'mat_rect')
               .attr('width',rect_width)
               .attr('height',rect_height)
               .attr('x',function (d,i) {
                   return  i*(rect_height+spacing);
               })
               .attr('fill',function (d) {
                   if(d.value==0) return 'white';
                   else
                       return d3.interpolateOrRd(d.value)
               }).on('mouseenter', function (d,i) {
                   if(d.source==undefined) return;
                   d3.selectAll('.mat_rect').classed('highlighted',false);
                   d3.select(this).classed('highlighted',true)
                   div.transition()
                   // .duration(200)
                       .style("opacity", 1);

                   var text = "";
                   d.value.forEach(function (value) { text +="Time: "+  value.Timestamp +"&nbsp; Lib: " +value.library +"<br>" })
                   console.log(text)
                   div.html("Number of calls: "+d.value.length+"</br>"+text)
                       .style("width","300px")
                       .style("height",function () {
                           return 20+ d.value.length * 15 +"px";
                       })
                       .style("left", (d3.event.pageX) + 20 + "px")
                       .style("top", (d3.event.pageY) + "px");

               })
               .on('mouseleave',function (d) {
                   d3.select(this).classed('highlighted',false);
               });

       })
       //Draw text

       var textGroup = svgMatrix.append('g').attr('transform','translate(200,'+matrix.length*(rect_height+spacing)+')')
       var text = textGroup.selectAll('text').data(lib).enter().append('text').attr('x',function (d,i) {
           return i*(rect_height+spacing);
       }).text(function (d) {
           return d;
       }).attr("class",  function (d,i) { return "colLabel mono c"+i;} )
           .attr('transform',function (d,i) {
               return 'rotate(45 '+i*(rect_height+spacing)+',0)';
           })

       var horizontalText = svgMatrix.append('g').attr('width',200);
       var horitext = horizontalText.selectAll('text')
           .data(group_by_process_name).enter().append('text').text(function (d) {
               return d.key;
           })
           .attr("class", function (d,i) { return "rowLabel mono r"+i;} )
           .attr('x',190)
           .attr('y',function (d,i) {
               return (i)*(rect_height+spacing) +rect_height/2;
           }).attr('text-anchor', 'end');


   }
</script>
<body>

</body>
</html>